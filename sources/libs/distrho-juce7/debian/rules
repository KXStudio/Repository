#!/usr/bin/make -f

include /usr/share/dpkg/kxstudio.mk

override_dh_auto_configure:
	dh_auto_configure -- \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/opt/kxstudio \
		-DJUCE_BUILD_HELPER_TOOLS=ON \
		-DJUCE_INSTALL_DESTINATION=lib/cmake/JUCE7

override_dh_auto_build:
	dh_auto_build
	make -C extras/Projucer/Builds/LinuxMakefile CONFIG=Release

override_dh_auto_clean:
	dh_auto_clean
	rm -rf extras/Projucer/Builds/LinuxMakefile/build

override_dh_auto_install:
	dh_auto_install
	install -d $(CURDIR)/debian/tmp/opt/kxstudio/bin
	install -m 755 $(CURDIR)/extras/Projucer/Builds/LinuxMakefile/build/Projucer \
		$(CURDIR)/debian/tmp/opt/kxstudio/bin/Projucer7
	install -m 755 $(CURDIR)/obj-*/extras/Build/juceaide/juceaide_artefacts/Release/juceaide \
		$(CURDIR)/debian/tmp/opt/kxstudio/bin/juceaide7
	mv $(CURDIR)/debian/tmp/opt/kxstudio/bin/JUCE-6.1.6/juce_lv2_helper \
		$(CURDIR)/debian/tmp/opt/kxstudio/bin/juce7_lv2_helper
	rmdir $(CURDIR)/debian/tmp/opt/kxstudio/bin/JUCE-6.1.6

%:
	dh $@ -Scmake
